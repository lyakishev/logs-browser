Процент логов дл данной подсистемы
select log, msgs/cast((select count(*) from this) as real) as percent from
(select log, cast (count(1) as integer) as msgs from this group by log order by msgs desc)

Group by timeinterval
 group by strftime('%Y%m%d%H0', date) + strftime('%M', date)/10
order by date desc
